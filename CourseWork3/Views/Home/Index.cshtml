@model List<CourseWork3.Models.AudioFile>
@using Microsoft.AspNetCore.Identity

@{
    ViewData["Title"] = "Главная";
}

<div class="text-center">
   

    @if (Model == null || !Model.Any())
    {
            <p>Нет загруженных файлов.</p>
    }
    else
    {
            <h3>Доступные аудиофайлы</h3>
            <ul class="list-unstyled">
            @foreach (var audio in Model)
            {
                        <li class="mb-4 border-bottom pb-3">
                            <p><strong>@audio.Title</strong> (@audio.OriginalName)</p>
                                    <p><strong>Жанр:</strong> @audio.Genre</p>

                            <p>
                                Опубликовал:
                        @if (!string.IsNullOrWhiteSpace(audio.User?.DisplayName))
                        {
                            @audio.User.DisplayName
                        }
                        else
                        {
                                        <em>Неизвестный пользователь</em>
                        }
                            </p>

                            <audio controls class="w-100" style="max-width: 400px;">
                                <source src="@Url.Action("Stream", "Audio", new { id = audio.Id })" type="audio/mpeg" />
                                Ваш браузер не поддерживает воспроизведение аудио.
                            </audio>

                            <div class="mt-2">
                                <form method="post" asp-controller="Audio" asp-action="Like" asp-route-id="@audio.Id" style="display:inline">
                                    <button type="submit" class="btn btn-outline-success btn-sm">👍 @audio.Likes</button>
                                </form>
                                <form method="post" asp-controller="Audio" asp-action="Dislike" asp-route-id="@audio.Id" style="display:inline">
                                    <button type="submit" class="btn btn-outline-danger btn-sm">👎 @audio.Dislikes</button>
                                </form>
                            </div>
                        </li>
            }
            </ul>
    }
</div>
